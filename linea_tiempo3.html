<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Línea de Tiempo de Filósofos Griegos</title>
    <script type="text/javascript" src="https://unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <link href="https://unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" />
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            background-color: #f0f0f0;
        }

        #timeline {
            width: 100%;
            height: 95vh;
            border: 1px solid lightgray;
            background-color: #ffffff;
        }

        .vis-item {
            border-color: #4A90E2;
            background-color: #D4E4F7;
            color: #333;
        }

            .vis-item.vis-selected {
                border-color: #FF5722;
                background-color: #FFDAB9;
            }

            .vis-item .vis-item-content {
                padding: 5px;
                display: flex;
                align-items: center;
            }

            .vis-item img {
                width: 30px;
                height: 30px;
                margin-right: 8px;
                border-radius: 50%;
                object-fit: cover;
            }

            /* Estilo para los eventos históricos */
            .vis-item.vis-background {
                background-color: rgba(230, 230, 250, 0.5); /* Lavanda claro semitransparente */
                border: none;
            }

            .vis-item.vis-point {
                background-color: #FFC107; /* Amarillo ámbar */
                border-color: #FFA000;
            }
    </style>
</head>
<body>

    <div id="timeline"></div>

    <script type="text/javascript">
        // Usamos una función asíncrona para cargar los datos antes de crear la línea de tiempo
        async function inicializarTimeline() {
            try {
                // 1. Cargar los datos de los ficheros JSON
                const [filosofos, eventosHistoricos] = await Promise.all([
                    fetch('filosofos.json').then(response => response.json()),
                    fetch('eventos.json').then(response => response.json())
                ]);

                // El resto del código es el mismo, pero se ejecuta después de cargar los datos

                // 2. Mapear los filósofos para que tengan el formato correcto de 'item'
                const itemsFilosofos = filosofos.map(f => ({
                    id: f.id,
                    group: f.id,
                    content: `<img src="${f.imagen}" alt="${f.nombre}"> ${f.nombre}`,
                    start: f.nacimiento,
                    end: f.muerte,
                    type: 'range'
                }));

                // 3. Combinar los filósofos y los eventos históricos
                const items = new vis.DataSet(itemsFilosofos.concat(eventosHistoricos));

                // 4. Crear los grupos a partir de los filósofos para la vista de grupos
                const groups = new vis.DataSet(filosofos.map(f => ({
                    id: f.id,
                    content: f.nombre
                })));

                // 5. Opciones de configuración para la línea de tiempo
                const options = {
                    stack: true,
                    stackSubgroups: true,
                    zoomMin: 1000 * 60 * 60 * 24 * 365 * 10, // 10 años
                    zoomMax: 1000 * 60 * 60 * 24 * 365 * 3000, // 3000 años
                    start: '-700',
                    end: '1500',
                    orientation: 'top',
                    groupOrder: 'content' // Ordenar grupos alfabéticamente
                };

                // 6. Crear la línea de tiempo
                const container = document.getElementById('timeline');
                const timeline = new vis.Timeline(container, items, groups, options);

            } catch (error) {
                console.error("Error al cargar los datos o inicializar la línea de tiempo:", error);
                document.getElementById('timeline').innerText = "Hubo un error al cargar los datos. Por favor, revisa la consola del navegador.";
            }
        }

        // Llamar a la función para que se inicie el proceso
        inicializarTimeline();

    </script>
</body>
</html>