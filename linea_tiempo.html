<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Línea de Tiempo de Filósofos Griegos</title>
    <script type="text/javascript" src="https://unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <link href="https://unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" />
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            background-color: #f0f0f0;
        }

        /* --- NUEVO: Estilos para los controles de navegación --- */
        .controles {
            padding: 10px;
            background-color: #e9e9e9;
            text-align: center;
            border-bottom: 1px solid lightgray;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

            .controles label {
                font-weight: bold;
            }

            .controles input {
                padding: 5px;
                width: 180px;
                border: 1px solid #ccc;
                border-radius: 4px;
            }

            .controles button {
                padding: 6px 12px;
                cursor: pointer;
                background-color: #4A90E2;
                color: white;
                border: none;
                border-radius: 4px;
            }

                .controles button:hover {
                    background-color: #357ABD;
                }
        /* --- FIN NUEVO --- */

        #timeline {
            width: 100%;
            height: calc(100vh - 55px); /* Ajustar altura para los controles */
            border: 1px solid lightgray;
            background-color: #ffffff;
        }

        .vis-item {
            border-color: #4A90E2;
            background-color: #D4E4F7;
            color: #333;
        }

            .vis-item.vis-selected {
                border-color: #FF5722;
                background-color: #FFDAB9;
            }

            .vis-item .vis-item-content {
                padding: 5px;
                display: flex;
                align-items: center;
            }

            .vis-item img {
                width: 30px;
                height: 30px;
                margin-right: 8px;
                border-radius: 50%;
                object-fit: cover;
            }

            .vis-item.vis-background {
                background-color: rgba(230, 230, 250, 0.5);
            }

            .vis-item.vis-point {
                background-color: #FFC107;
                border-color: #FFA000;
            }
    </style>
</head>
<body>

    <!-- NUEVO: Controles para navegar a un siglo específico -->
    <div class="controles">
        <label for="sigloInput">Ir al siglo:</label>
        <input type="number" id="sigloInput" placeholder="Ej: -5 para V a.C., 15 para XV d.C.">
        <button id="irASigloBtn">Ir</button>
    </div>
    <!-- FIN NUEVO -->

    <div id="timeline"></div>

    <script type="text/javascript">
        // --- NUEVO: Declaramos la variable timeline fuera para que sea accesible globalmente ---
        let timeline = null;

        // Usamos una función asíncrona para cargar los datos antes de crear la línea de tiempo
        async function inicializarTimeline() {
            try {
                // 1. Cargar los datos de los ficheros JSON
                const [filosofos, eventosHistoricos] = await Promise.all([
                    fetch('filosofos.json').then(response => response.json()),
                    fetch('eventos.json').then(response => response.json())
                ]);

                // 2. Mapear los filósofos
                const itemsFilosofos = filosofos.map(f => ({
                    id: f.id,
                    group: f.id,
                    content: `<img src="${f.imagen}" alt="${f.nombre}"> ${f.nombre}`,
                    start: f.nacimiento,
                    end: f.muerte,
                    type: 'range'
                }));

                // 3. Combinar datos
                const items = new vis.DataSet(itemsFilosofos.concat(eventosHistoricos));

                // 4. Crear los grupos
                const groups = new vis.DataSet(filosofos.map(f => ({
                    id: f.id,
                    content: f.nombre
                })));

                // 5. Opciones de configuración
                const options = {
                    stack: true,
                    stackSubgroups: true,
                    zoomMin: 1000 * 60 * 60 * 24 * 365 * 10,
                    zoomMax: 1000 * 60 * 60 * 24 * 365 * 3000,
                    start: '-700',
                    end: '1500',
                    orientation: 'top',
                    groupOrder: 'content'
                };

                // 6. Crear la línea de tiempo
                const container = document.getElementById('timeline');
                // --- NUEVO: Asignamos a la variable global ---
                timeline = new vis.Timeline(container, items, groups, options);

            } catch (error) {
                console.error("Error al cargar los datos o inicializar la línea de tiempo:", error);
                document.getElementById('timeline').innerText = "Hubo un error al cargar los datos. Por favor, revisa la consola del navegador.";
            }
        }

        // Llamar a la función para que se inicie el proceso
        inicializarTimeline();

        // --- NUEVO: Lógica para el botón de navegación por siglo ---
        document.getElementById('irASigloBtn').addEventListener('click', function() {
            const sigloInput = document.getElementById('sigloInput');
            const siglo = parseInt(sigloInput.value, 10);

            if (isNaN(siglo) || siglo === 0) {
                alert("Por favor, introduce un número de siglo válido (distinto de cero).\nUsa números negativos para los siglos antes de Cristo.");
                return;
            }

            // Si la línea de tiempo no se ha creado, no hacemos nada
            if (!timeline) {
                console.error("La línea de tiempo aún no está inicializada.");
                return;
            }

            let anioInicio;
            if (siglo > 0) {
                // El siglo XV (15) empieza en el año 1400. Fórmula: (siglo - 1) * 100
                anioInicio = (siglo - 1) * 100;
            } else { // siglo < 0
                // El siglo V a.C. (-5) empieza en el año -500. Fórmula: siglo * 100
                anioInicio = siglo * 100;
            }

            // Mover la línea de tiempo al año calculado con una animación suave
            timeline.moveTo(anioInicio.toString(), {
                animation: {
                    duration: 1000, // 1 segundo
                    easingFunction: 'easeInOutQuad'
                }
            });
        });
        // --- FIN NUEVO ---
    </script>
</body>
</html>